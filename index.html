<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AIFreelance Hub ‚Äì Hire AI-Powered Freelancers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="AIFreelance Hub ‚Äì Task marketplace to hire AI-powered freelancers for writing, design and automation.">
  <link rel="icon" type="image/png" href="favicon.png" />

  <style>
    :root {
      --bg: #050816;
      --bg-elevated: #0b1120;
      --bg-soft: #020617;
      --primary: #3b82f6;
      --primary-soft: rgba(59,130,246,0.15);
      --accent: #22d3ee;
      --border: #1f2937;
      --text-main: #e5e7eb;
      --text-soft: #9ca3af;
      --danger: #f97373;
      --success: #4ade80;
      --radius-lg: 18px;
      --radius-full: 999px;
      --shadow-soft: 0 18px 45px rgba(15,23,42,0.75);
      --transition-fast: 0.18s ease-out;
      --nav-height: 70px;
    }

    * { box-sizing: border-box; margin:0; padding:0; }
    html, body {
      background: radial-gradient(circle at top, #0b1120 0, #020617 45%, #000 100%);
      color: var(--text-main);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.5;
    }
    body { min-height: 100vh; }

    a { color: inherit; text-decoration: none; }

    /* Layout */
    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .container {
      width: 100%;
      max-width: 1120px;
      margin: 0 auto;
      padding: 0 16px;
    }

    /* Header */
    header {
      position: sticky;
      top: 0;
      z-index: 40;
      backdrop-filter: blur(18px);
      background: linear-gradient(to bottom,
        rgba(5,6,24,0.95),
        rgba(5,6,24,0.7),
        transparent
      );
      border-bottom: 1px solid rgba(15,23,42,0.8);
    }
    .nav {
      height: var(--nav-height);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .brand-logo {
      width: 44px;
      height: 44px;
      border-radius: 20%;
      background: radial-gradient(circle at 20% 20%, #e5f2ff, #3b82f6 45%, #1d4ed8 85%);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 35px rgba(59,130,246,0.85);
      font-weight: 800;
      font-size: 24px;
      color: #e5f2ff;
    }
    .brand-text-title {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 0.02em;
    }
    .brand-text-sub {
      font-size: 11px;
      color: var(--text-soft);
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .lang-select {
      background: rgba(15,23,42,0.9);
      border-radius: var(--radius-full);
      border: 1px solid var(--border);
      color: var(--text-soft);
      font-size: 13px;
      padding: 6px 12px;
      outline: none;
    }
    .nav-btn {
      border-radius: var(--radius-full);
      font-size: 13px;
      padding: 7px 16px;
      border: 1px solid transparent;
      cursor: pointer;
      transition: background var(--transition-fast), border var(--transition-fast),
        transform var(--transition-fast), box-shadow var(--transition-fast), color var(--transition-fast);
      white-space: nowrap;
    }
    .nav-btn-outline {
      background: transparent;
      border-color: var(--border);
      color: var(--text-soft);
    }
    .nav-btn-outline:hover {
      border-color: var(--primary);
      color: var(--primary);
      transform: translateY(-1px);
    }
    .nav-btn-primary {
      background: linear-gradient(135deg, var(--primary), #2563eb);
      color: #f9fafb;
      box-shadow: 0 10px 25px rgba(37,99,235,0.7);
    }
    .nav-btn-primary:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
      box-shadow: 0 16px 40px rgba(37,99,235,0.8);
    }

    /* Hero */
    main {
      flex: 1;
    }
    .hero {
      padding: 32px 0 24px;
    }
    .hero-inner {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
      gap: 32px;
      align-items: center;
    }
    @media (max-width: 880px) {
      .hero-inner {
        grid-template-columns: minmax(0, 1fr);
      }
    }
    .hero-title {
      font-size: clamp(26px, 4vw, 36px);
      font-weight: 800;
      letter-spacing: 0.03em;
      margin-bottom: 10px;
    }
    .hero-title-gradient {
      background: linear-gradient(135deg, #60a5fa, #22d3ee);
      -webkit-background-clip: text;
      color: transparent;
    }
    .hero-subtitle {
      font-size: 15px;
      color: var(--text-soft);
      max-width: 520px;
    }
    .hero-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0 24px;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      padding: 6px 11px;
      border-radius: var(--radius-full);
      border: 1px solid rgba(55,65,81,0.9);
      background: radial-gradient(circle at top left, rgba(59,130,246,0.15), rgba(15,23,42,0.95));
      color: var(--text-soft);
    }
    .badge-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: linear-gradient(135deg, #22c55e, #4ade80);
      box-shadow: 0 0 0 4px rgba(34,197,94,0.25);
    }

    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 18px;
    }
    .hero-note {
      font-size: 12px;
      color: var(--text-soft);
    }

    .hero-card {
      background: radial-gradient(circle at top, rgba(56,189,248,0.07), rgba(15,23,42,0.98));
      border-radius: 26px;
      border: 1px solid rgba(31,41,55,0.9);
      padding: 20px 18px;
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }
    .hero-card::before {
      content: "";
      position: absolute;
      inset: -80px;
      background:
        radial-gradient(circle at top left, rgba(59,130,246,0.26), transparent 55%),
        radial-gradient(circle at bottom right, rgba(45,212,191,0.3), transparent 55%);
      opacity: 0.6;
      pointer-events: none;
    }
    .hero-card-inner {
      position: relative;
      z-index: 1;
    }
    .hero-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    .hero-pill {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: var(--radius-full);
      background: rgba(15,23,42,0.85);
      border: 1px solid rgba(55,65,81,0.9);
      color: var(--text-soft);
    }
    .hero-stats {
      display: flex;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 14px;
      font-size: 11px;
      color: var(--text-soft);
    }
    .hero-stats strong { color: #e5e7eb; }
    .hero-card-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
      font-size: 11px;
      color: var(--text-soft);
    }

    /* Sections */
    section {
      padding: 8px 0 32px;
    }
    .section-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 14px;
    }
    .section-title {
      font-size: 18px;
      font-weight: 600;
    }
    .section-sub {
      font-size: 12px;
      color: var(--text-soft);
    }

    /* Task Board */
    .card {
      background: linear-gradient(to bottom right, rgba(15,23,42,0.96), rgba(15,23,42,0.98));
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      padding: 16px 14px;
      box-shadow: 0 8px 28px rgba(15,23,42,0.7);
    }
    .task-toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 14px;
      font-size: 12px;
      align-items: center;
    }
    .input, .select {
      background: #020617;
      border-radius: 10px;
      border: 1px solid #1f2937;
      padding: 6px 9px;
      font-size: 12px;
      color: var(--text-main);
      outline: none;
      min-width: 0;
    }
    .input::placeholder {
      color: #6b7280;
    }
    .select {
      padding-right: 26px;
    }
    .task-toolbar .btn-sm {
      font-size: 12px;
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid var(--primary);
      background: rgba(37,99,235,0.12);
      color: #bfdbfe;
      cursor: pointer;
      transition: var(--transition-fast);
      white-space: nowrap;
    }
    .task-toolbar .btn-sm:hover {
      background: rgba(37,99,235,0.32);
    }

    .task-table-wrapper {
      border-radius: 14px;
      border: 1px solid rgba(31,41,55,0.9);
      overflow: hidden;
      background: radial-gradient(circle at top left, rgba(30,64,175,0.18), rgba(15,23,42,1));
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }
    thead {
      background: rgba(15,23,42,0.92);
    }
    th, td {
      padding: 9px 10px;
      text-align: left;
      border-bottom: 1px solid rgba(31,41,55,0.75);
    }
    th {
      font-weight: 500;
      color: #9ca3af;
      white-space: nowrap;
    }
    tbody tr:last-child td {
      border-bottom: none;
    }
    tbody tr:hover {
      background: rgba(15,23,42,0.9);
    }
    .task-title {
      font-weight: 500;
      font-size: 13px;
      color: #e5e7eb;
    }
    .task-meta {
      display: block;
      font-size: 11px;
      color: var(--text-soft);
    }
    .badge-status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 10px;
      border-radius: 999px;
      font-size: 11px;
      border: 1px solid rgba(55,65,81,1);
    }
    .badge-status-open {
      border-color: rgba(34,197,94,0.7);
      color: #bbf7d0;
      background: rgba(22,163,74,0.12);
    }
    .badge-status-progress {
      border-color: rgba(59,130,246,0.7);
      color: #bfdbfe;
      background: rgba(37,99,235,0.12);
    }
    .badge-status-completed {
      border-color: rgba(148,163,184,0.9);
      color: #cbd5f5;
      background: rgba(15,23,42,0.5);
    }
    .btn-table {
      border-radius: 999px;
      padding: 5px 11px;
      border: 1px solid rgba(31,41,55,1);
      background: rgba(15,23,42,0.9);
      color: #e5e7eb;
      font-size: 11px;
      cursor: pointer;
      margin-left: 6px;
      transition: var(--transition-fast);
      white-space: nowrap;
    }
    .btn-accept {
      border-color: rgba(34,197,94,0.7);
      color: #bbf7d0;
      background: rgba(22,163,74,0.08);
    }
    .btn-accept:hover {
      background: rgba(22,163,74,0.22);
    }
    .btn-pay {
      border-color: rgba(59,130,246,0.7);
      color: #bfdbfe;
      background: rgba(37,99,235,0.15);
    }
    .btn-pay:hover {
      background: rgba(37,99,235,0.3);
    }
    .btn-disabled {
      opacity: 0.4;
      pointer-events: none;
    }

    /* Info sections */
    .info-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 14px;
    }
    @media (max-width: 880px) {
      .info-grid {
        grid-template-columns: minmax(0,1fr);
      }
    }
    .info-card {
      background: rgba(15,23,42,0.96);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      padding: 14px 14px 12px;
      font-size: 12px;
      color: var(--text-soft);
    }
    .info-card-title {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 6px;
      color: #e5e7eb;
    }
    .dot-list {
      list-style: none;
      padding-left: 0;
    }
    .dot-list li {
      position: relative;
      padding-left: 14px;
      margin-bottom: 4px;
    }
    .dot-list li::before {
      content: "‚Ä¢";
      position: absolute;
      left: 3px;
      color: #6b7280;
    }

    /* Footer */
    footer {
      border-top: 1px solid rgba(15,23,42,0.9);
      padding: 14px 0 18px;
      font-size: 11px;
      color: var(--text-soft);
    }
    .footer-inner {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 10px;
      align-items: center;
    }

    /* Modals */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15,23,42,0.86);
      backdrop-filter: blur(12px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
      padding: 16px;
    }
    .modal {
      width: 100%;
      max-width: 420px;
      background: #020617;
      border-radius: 20px;
      border: 1px solid var(--border);
      box-shadow: 0 18px 50px rgba(15,23,42,0.9);
      padding: 18px 18px 16px;
      position: relative;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .modal-title {
      font-size: 16px;
      font-weight: 600;
    }
    .modal-close {
      border: none;
      background: transparent;
      color: var(--text-soft);
      cursor: pointer;
      font-size: 18px;
    }
    .modal-body {
      font-size: 13px;
    }
    .form-group {
      margin-bottom: 10px;
    }
    .label {
      display: block;
      font-size: 12px;
      color: var(--text-soft);
      margin-bottom: 4px;
    }
    .radio-row {
      display: flex;
      gap: 14px;
      font-size: 12px;
      color: var(--text-soft);
      margin-bottom: 4px;
    }
    .textarea {
      width: 100%;
      min-height: 80px;
      resize: vertical;
      background: #020617;
      border-radius: 10px;
      border: 1px solid #1f2937;
      padding: 7px 9px;
      font-size: 12px;
      color: var(--text-main);
      outline: none;
    }
    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 8px;
    }
    .btn {
      border-radius: 999px;
      padding: 7px 15px;
      border: 1px solid transparent;
      font-size: 13px;
      cursor: pointer;
      white-space: nowrap;
      transition: var(--transition-fast);
    }
    .btn-secondary {
      background: transparent;
      border-color: #1f2937;
      color: var(--text-soft);
    }
    .btn-secondary:hover {
      border-color: #4b5563;
      color: #e5e7eb;
    }
    .btn-primary {
      background: linear-gradient(135deg, var(--primary), #2563eb);
      color: #f9fafb;
      box-shadow: 0 10px 25px rgba(37,99,235,0.7);
    }
    .btn-primary:hover {
      filter: brightness(1.05);
      box-shadow: 0 16px 40px rgba(37,99,235,0.8);
    }
    .helper-text {
      font-size: 11px;
      color: var(--text-soft);
      margin-top: 4px;
    }
    .error-text {
      color: var(--danger);
      font-size: 11px;
      margin-top: 3px;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border-radius: 999px;
      padding: 3px 9px;
      font-size: 11px;
      border: 1px solid rgba(55,65,81,1);
      color: var(--text-soft);
    }
  </style>
</head>
<body>
<div class="page">
  <!-- Header -->
  <header>
    <div class="container">
      <div class="nav">
        <div class="brand">
          <div class="brand-logo">A</div>
          <div>
            <div class="brand-text-title" data-i18n="brand_title">AIFreelance Hub</div>
            <div class="brand-text-sub" data-i18n="brand_sub">
              Hire AI-powered freelancers worldwide
            </div>
          </div>
        </div>
        <div class="nav-right">
          <select id="langSelect" class="lang-select" title="Language">
            <option value="en">English</option>
            <option value="zh">‰∏≠Êñá</option>
            <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
            <option value="fr">Fran√ßais</option>
            <option value="de">Deutsch</option>
          </select>
          <button id="btnNavLogin" class="nav-btn nav-btn-outline" data-i18n="nav_login">
            Log in / Sign up
          </button>
          <button id="btnNavNewTask" class="nav-btn nav-btn-primary" data-i18n="nav_post_task">
            Post a Task
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main>
    <section class="hero">
      <div class="container hero-inner">
        <div>
          <h1 class="hero-title">
            <span data-i18n="hero_title_1">Hire AI-powered</span>
            <span class="hero-title-gradient" data-i18n="hero_title_2">
              Freelancers & Automation Experts
            </span>
          </h1>
          <p class="hero-subtitle" data-i18n="hero_sub">
            Post tasks, hire vetted AI freelancers, and get paid automatically through
            Stripe ‚Äì one dashboard for writing, design and automation.
          </p>

          <div class="hero-badges">
            <span class="badge">
              <span class="badge-dot"></span>
              <span data-i18n="hero_badge_1">US / UK / EU clients ready</span>
            </span>
            <span class="badge">
              ‚ö° <span data-i18n="hero_badge_2">AI-assisted, human-reviewed output</span>
            </span>
            <span class="badge">
              üí≥ <span data-i18n="hero_badge_3">Stripe online payments</span>
            </span>
          </div>

          <div class="hero-actions">
            <button id="btnHeroPost" class="btn btn-primary" data-i18n="hero_cta_client">
              Post a client task
            </button>
            <button id="btnHeroFreelancer" class="btn btn-secondary" data-i18n="hero_cta_freelancer">
              I am a freelancer
            </button>
          </div>
          <p class="hero-note" data-i18n="hero_note">
            Clear pricing. Talk directly via WhatsApp or email after you accept a task.
          </p>
        </div>

        <div class="hero-card">
          <div class="hero-card-inner">
            <div class="hero-card-header">
              <span class="hero-pill" data-i18n="hero_card_title">
                Live Task Snapshot
              </span>
              <span class="pill">
                ü™ô <span data-i18n="hero_card_safe">Secure Stripe payouts</span>
              </span>
            </div>
            <div class="hero-stats">
              <span data-i18n="hero_card_stat1">
                Open tasks: <strong id="statOpen">0</strong>
              </span>
              <span data-i18n="hero_card_stat2">
                In progress: <strong id="statProgress">0</strong>
              </span>
              <span data-i18n="hero_card_stat3">
                Completed: <strong id="statCompleted">0</strong>
              </span>
            </div>
            <div class="task-table-wrapper" style="margin-top:6px;">
              <table>
                <thead>
                <tr>
                  <th data-i18n="tbl_task">Task</th>
                  <th data-i18n="tbl_budget">Budget</th>
                  <th data-i18n="tbl_status">Status</th>
                </tr>
                </thead>
                <tbody id="heroMiniTasks"></tbody>
              </table>
            </div>
            <div class="hero-card-footer">
              <span data-i18n="hero_card_footer">
                New AI writing & automation tasks added daily.
              </span>
              <button id="btnHeroViewAll" class="btn-table" style="margin-left:10px;" data-i18n="hero_view_all">
                View all
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Task Board -->
    <section>
      <div class="container">
        <div class="section-header">
          <div>
            <h2 class="section-title" data-i18n="section_tasks_title">Task Marketplace</h2>
            <p class="section-sub" data-i18n="section_tasks_sub">
              Clients and freelancers can manage everything here ‚Äì post tasks,
              accept work, and pay via Stripe.
            </p>
          </div>
        </div>

        <div class="card">
          <div class="task-toolbar">
            <input id="searchInput" class="input" type="text" placeholder="Search tasks‚Ä¶" />
            <select id="filterStatus" class="select">
              <option value="all" data-i18n="filter_status_all">All statuses</option>
              <option value="open" data-i18n="filter_status_open">Open</option>
              <option value="in_progress" data-i18n="filter_status_progress">In progress</option>
              <option value="completed" data-i18n="filter_status_completed">Completed</option>
            </select>
            <select id="filterRoleView" class="select">
              <option value="all" data-i18n="filter_role_all">All roles</option>
              <option value="client" data-i18n="filter_role_client">My posted tasks</option>
              <option value="freelancer" data-i18n="filter_role_freelancer">My accepted tasks</option>
            </select>
            <button id="btnNewTask" class="btn-sm" data-i18n="btn_post_task">
              + Post a new task
            </button>
            <span class="helper-text" style="margin-left:auto;" id="currentUserLabel"></span>
          </div>

          <div class="task-table-wrapper">
            <table>
              <thead>
              <tr>
                <th data-i18n="tbl_task">Task</th>
                <th data-i18n="tbl_budget">Budget</th>
                <th data-i18n="tbl_client">Client</th>
                <th data-i18n="tbl_location">Location</th>
                <th data-i18n="tbl_status">Status</th>
                <th data-i18n="tbl_actions">Actions</th>
              </tr>
              </thead>
              <tbody id="taskTableBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- Info: How it works & Pricing -->
    <section>
      <div class="container">
        <div class="section-header">
          <div>
            <h2 class="section-title" data-i18n="section_how_title">How AIFreelance Hub works</h2>
            <p class="section-sub" data-i18n="section_how_sub">
              A simple flow for both clients and freelancers. You decide the pricing and Stripe payout rules.
            </p>
          </div>
        </div>

        <div class="info-grid">
          <article class="info-card">
            <h3 class="info-card-title" data-i18n="how_client_title">For clients</h3>
            <ul class="dot-list">
              <li data-i18n="how_client_1">Post a task with your budget and Stripe payment link.</li>
              <li data-i18n="how_client_2">Review freelancers who accept, chat via WhatsApp or email.</li>
              <li data-i18n="how_client_3">Pay securely through Stripe and receive AI-assisted results.</li>
            </ul>
          </article>

          <article class="info-card">
            <h3 class="info-card-title" data-i18n="how_freelancer_title">For freelancers</h3>
            <ul class="dot-list">
              <li data-i18n="how_freelancer_1">Create a freelancer account and complete your profile.</li>
              <li data-i18n="how_freelancer_2">Browse open tasks and accept the ones that match your skills.</li>
              <li data-i18n="how_freelancer_3">Deliver work and coordinate Stripe payouts with the client.</li>
            </ul>
          </article>

          <article class="info-card">
            <h3 class="info-card-title" data-i18n="how_owner_title">For platform owner (you)</h3>
            <ul class="dot-list">
              <li data-i18n="how_owner_1">Use Stripe prices or Payment Links with a built-in platform fee.</li>
              <li data-i18n="how_owner_2">Decide which clients and freelancers you invite into the system.</li>
              <li data-i18n="how_owner_3">Focus on marketing and relationships ‚Äì the site handles workflows.</li>
            </ul>
          </article>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-inner">
        <span>&copy; <span id="year"></span> AIFreelance Hub.</span>
        <span data-i18n="footer_rights">All rights reserved. This site does not store payment details ‚Äì Stripe handles all payments.</span>
      </div>
    </div>
  </footer>
</div>

<!-- Login / Register Modal -->
<div class="modal-backdrop" id="authModal">
  <div class="modal">
    <div class="modal-header">
      <div>
        <h3 class="modal-title" data-i18n="auth_title">Log in / Sign up</h3>
        <p class="helper-text" data-i18n="auth_sub">
          One account can both post tasks and work as a freelancer.
        </p>
      </div>
      <button class="modal-close" data-close="authModal">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="label" for="authEmail" data-i18n="auth_email">Email</label>
        <input id="authEmail" type="email" class="input" placeholder="you@example.com" />
      </div>
      <div class="form-group">
        <label class="label" for="authName" data-i18n="auth_name">Display name</label>
        <input id="authName" type="text" class="input" placeholder="Your name on the platform" />
      </div>
      <div class="form-group">
        <label class="label" for="authPassword" data-i18n="auth_password">Password</label>
        <input id="authPassword" type="password" class="input" placeholder="Minimum 6 characters" />
      </div>
      <div class="form-group">
        <div class="label" data-i18n="auth_role_label">Default role after login</div>
        <div class="radio-row">
          <label><input type="radio" name="authRole" value="client" checked /> <span data-i18n="auth_role_client">Client</span></label>
          <label><input type="radio" name="authRole" value="freelancer" /> <span data-i18n="auth_role_freelancer">Freelancer</span></label>
        </div>
      </div>
      <div id="authError" class="error-text" style="display:none;"></div>
      <div class="modal-actions">
        <button class="btn btn-secondary" data-close="authModal" data-i18n="btn_cancel">Cancel</button>
        <button id="btnAuthSubmit" class="btn btn-primary" data-i18n="auth_submit">Continue</button>
      </div>
    </div>
  </div>
</div>

<!-- New Task Modal -->
<div class="modal-backdrop" id="taskModal">
  <div class="modal">
    <div class="modal-header">
      <div>
        <h3 class="modal-title" data-i18n="task_modal_title">Post a new task</h3>
        <p class="helper-text" data-i18n="task_modal_sub">
          Add as much detail as possible. You can paste a Stripe Payment Link for online payment.
        </p>
      </div>
      <button class="modal-close" data-close="taskModal">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="label" for="taskTitle" data-i18n="task_title_label">Title</label>
        <input id="taskTitle" class="input" placeholder="e.g. AI long-form article about retirement investing" />
      </div>
      <div class="form-group">
        <label class="label" for="taskDescription" data-i18n="task_desc_label">Description</label>
        <textarea id="taskDescription" class="textarea"
                  placeholder="Explain what you need, target audience, style, tone, and deadline."></textarea>
      </div>
      <div class="form-group">
        <label class="label" data-i18n="task_budget_label">Budget</label>
        <div style="display:flex; gap:8px;">
          <select id="taskCurrency" class="select" style="max-width:90px;">
            <option value="USD">$ USD</option>
            <option value="EUR">‚Ç¨ EUR</option>
            <option value="GBP">¬£ GBP</option>
          </select>
          <input id="taskBudget" type="number" class="input" min="0" step="1" style="flex:1;" placeholder="450" />
        </div>
      </div>
      <div class="form-group">
        <label class="label" for="taskLocation" data-i18n="task_location_label">Client location (optional)</label>
        <input id="taskLocation" class="input" placeholder="e.g. Houston, TX ¬∑ United States" />
      </div>
      <div class="form-group">
        <label class="label" for="taskStripeLink" data-i18n="task_stripe_label">Stripe Payment Link (optional)</label>
        <input id="taskStripeLink" class="input" placeholder="https://buy.stripe.com/..." />
        <p class="helper-text" data-i18n="task_stripe_helper">
          Use a real Stripe Payment Link when you are in live mode. If this field is empty, the ‚ÄúPay with Stripe‚Äù button will be hidden.
        </p>
      </div>
      <div id="taskError" class="error-text" style="display:none;"></div>
      <div class="modal-actions">
        <button class="btn btn-secondary" data-close="taskModal" data-i18n="btn_cancel">Cancel</button>
        <button id="btnTaskSubmit" class="btn btn-primary" data-i18n="task_submit">Save task</button>
      </div>
    </div>
  </div>
</div>

<script>
  // ------- Simple local storage keys -------
  const STORAGE_KEYS = {
    user: 'afh_current_user',
    users: 'afh_users',
    tasks: 'afh_tasks',
    lang: 'afh_lang'
  };

  // ------- i18n dictionary -------
  const translations = {
    en: {
      brand_title: 'AIFreelance Hub',
      brand_sub: 'Hire AI-powered freelancers worldwide',
      nav_login: 'Log in / Sign up',
      nav_post_task: 'Post a Task',
      hero_title_1: 'Hire AI-powered',
      hero_title_2: 'Freelancers & Automation Experts',
      hero_sub: 'Post tasks, hire vetted AI freelancers, and get paid automatically through Stripe ‚Äì one dashboard for writing, design and automation.',
      hero_badge_1: 'US / UK / EU clients ready',
      hero_badge_2: 'AI-assisted, human-reviewed output',
      hero_badge_3: 'Stripe online payments',
      hero_cta_client: 'Post a client task',
      hero_cta_freelancer: 'I am a freelancer',
      hero_note: 'Clear pricing. Talk directly via WhatsApp or email after you accept a task.',
      hero_card_title: 'Live Task Snapshot',
      hero_card_safe: 'Secure Stripe payouts',
      hero_card_stat1: 'Open tasks:',
      hero_card_stat2: 'In progress:',
      hero_card_stat3: 'Completed:',
      hero_card_footer: 'New AI writing & automation tasks added daily.',
      hero_view_all: 'View all',
      section_tasks_title: 'Task Marketplace',
      section_tasks_sub: 'Clients and freelancers can manage everything here ‚Äì post tasks, accept work, and pay via Stripe.',
      filter_status_all: 'All statuses',
      filter_status_open: 'Open',
      filter_status_progress: 'In progress',
      filter_status_completed: 'Completed',
      filter_role_all: 'All roles',
      filter_role_client: 'My posted tasks',
      filter_role_freelancer: 'My accepted tasks',
      btn_post_task: '+ Post a new task',
      tbl_task: 'Task',
      tbl_budget: 'Budget',
      tbl_client: 'Client',
      tbl_location: 'Location',
      tbl_status: 'Status',
      tbl_actions: 'Actions',
      section_how_title: 'How AIFreelance Hub works',
      section_how_sub: 'A simple flow for both clients and freelancers. You decide the pricing and Stripe payout rules.',
      how_client_title: 'For clients',
      how_client_1: 'Post a task with your budget and Stripe payment link.',
      how_client_2: 'Review freelancers who accept, chat via WhatsApp or email.',
      how_client_3: 'Pay securely through Stripe and receive AI-assisted results.',
      how_freelancer_title: 'For freelancers',
      how_freelancer_1: 'Create a freelancer account and complete your profile.',
      how_freelancer_2: 'Browse open tasks and accept the ones that match your skills.',
      how_freelancer_3: 'Deliver work and coordinate Stripe payouts with the client.',
      how_owner_title: 'For platform owner (you)',
      how_owner_1: 'Use Stripe prices or Payment Links with a built-in platform fee.',
      how_owner_2: 'Decide which clients and freelancers you invite into the system.',
      how_owner_3: 'Focus on marketing and relationships ‚Äì the site handles workflows.',
      footer_rights: 'All rights reserved. This site does not store payment details ‚Äì Stripe handles all payments.',
      auth_title: 'Log in / Sign up',
      auth_sub: 'One account can both post tasks and work as a freelancer.',
      auth_email: 'Email',
      auth_name: 'Display name',
      auth_password: 'Password',
      auth_role_label: 'Default role after login',
      auth_role_client: 'Client',
      auth_role_freelancer: 'Freelancer',
      auth_submit: 'Continue',
      btn_cancel: 'Cancel',
      task_modal_title: 'Post a new task',
      task_modal_sub: 'Add as much detail as possible. You can paste a Stripe Payment Link for online payment.',
      task_title_label: 'Title',
      task_desc_label: 'Description',
      task_budget_label: 'Budget',
      task_location_label: 'Client location (optional)',
      task_stripe_label: 'Stripe Payment Link (optional)',
      task_stripe_helper: 'Use a real Stripe Payment Link when you are in live mode. If this field is empty, the ‚ÄúPay with Stripe‚Äù button will be hidden.',
      task_submit: 'Save task'
    },
    zh: {
      brand_title: 'AIFreelance Hub',
      brand_sub: 'Èõá‰Ω£Áî± AI È©±Âä®ÁöÑÂÖ®ÁêÉËá™Áî±ËÅå‰∏öËÄÖ',
      nav_login: 'ÁôªÂΩï / Ê≥®ÂÜå',
      nav_post_task: 'ÂèëÂ∏É‰ªªÂä°',
      hero_title_1: 'Èõá‰Ω£ AI È©±Âä®ÁöÑ',
      hero_title_2: 'Ëá™Áî±ËÅå‰∏öËÄÖÂíåËá™Âä®Âåñ‰∏ìÂÆ∂',
      hero_sub: 'Âú®‰∏Ä‰∏™Âπ≥Âè∞‰∏äÂÆåÊàêÂèëÂçï„ÄÅÊé•Âçï„ÄÅStripe Âú®Á∫øÊî∂Ê¨æ‚Äî‚ÄîÁî®‰∫éÂÜô‰Ωú„ÄÅËÆæËÆ°ÂíåËá™Âä®Âåñ„ÄÇ',
      hero_badge_1: 'ÊîØÊåÅÁæéÂõΩ / Ëã±ÂõΩ / Ê¨ßÊ¥≤ÂÆ¢Êà∑',
      hero_badge_2: 'AI + ‰∫∫Â∑•Â§çÂÆ°ÔºåÈ´òË¥®ÈáèËæìÂá∫',
      hero_badge_3: 'Stripe Âú®Á∫ø‰ªòÊ¨æ',
      hero_cta_client: 'ÊàëÊòØÂÆ¢Êà∑ÔºåË¶ÅÂèë‰ªªÂä°',
      hero_cta_freelancer: 'ÊàëÊòØËá™Áî±ËÅå‰∏öËÄÖ',
      hero_note: '‰ª∑Ê†ºÈÄèÊòé„ÄÇÊé•ÂçïÂêéÂèØ‰ª•ÈÄöËøá WhatsApp ÊàñÈÇÆÁÆ±Áõ¥Êé•Ê≤üÈÄö„ÄÇ',
      hero_card_title: 'ÂÆûÊó∂‰ªªÂä°Âø´ÁÖß',
      hero_card_safe: 'Stripe ÂÆâÂÖ®ÁªìÁÆó',
      hero_card_stat1: 'ÂºÄÊîæ‰ªªÂä°Ôºö',
      hero_card_stat2: 'ËøõË°å‰∏≠Ôºö',
      hero_card_stat3: 'Â∑≤ÂÆåÊàêÔºö',
      hero_card_footer: 'ÊØèÂ§©ÈÉΩ‰ºöÊñ∞Â¢û AI ÂÜô‰Ωú‰∏éËá™Âä®Âåñ‰ªªÂä°„ÄÇ',
      hero_view_all: 'Êü•ÁúãÂÖ®ÈÉ®‰ªªÂä°',
      section_tasks_title: '‰ªªÂä°Â§ßÂéÖ',
      section_tasks_sub: 'ÂÆ¢Êà∑ÂíåËá™Áî±ËÅå‰∏öËÄÖÂú®ËøôÈáåÂÆåÊàêÂÖ®ÈÉ®ÊµÅÁ®ãÔºöÂèë‰ªªÂä°„ÄÅÊé•‰ªªÂä°„ÄÅStripe ÊîØ‰ªò„ÄÇ',
      filter_status_all: 'ÂÖ®ÈÉ®Áä∂ÊÄÅ',
      filter_status_open: 'ÂºÄÊîæ‰∏≠',
      filter_status_progress: 'ËøõË°å‰∏≠',
      filter_status_completed: 'Â∑≤ÂÆåÊàê',
      filter_role_all: 'ÂÖ®ÈÉ®‰ªªÂä°',
      filter_role_client: 'ÊàëÂèëÂ∏ÉÁöÑ‰ªªÂä°',
      filter_role_freelancer: 'ÊàëÊé•ÁöÑ‰ªªÂä°',
      btn_post_task: '+ ÂèëÂ∏ÉÊñ∞‰ªªÂä°',
      tbl_task: '‰ªªÂä°',
      tbl_budget: 'È¢ÑÁÆó',
      tbl_client: 'ÂÆ¢Êà∑',
      tbl_location: 'Âú∞Âå∫',
      tbl_status: 'Áä∂ÊÄÅ',
      tbl_actions: 'Êìç‰Ωú',
      section_how_title: 'Âπ≥Âè∞Â¶Ç‰ΩïËøê‰Ωú',
      section_how_sub: 'ÂØπÂÆ¢Êà∑ÂíåËá™Áî±ËÅå‰∏öËÄÖÈÉΩÊòØÊûÅÁÆÄÊµÅÁ®ãÔºå‰Ω†Êù•ÂÜ≥ÂÆöÊî∂Ë¥πÊñπÂºèÂíå Stripe ÂàÜÊàê„ÄÇ',
      how_client_title: 'ÂÆ¢Êà∑',
      how_client_1: 'Â°´ÂÜô‰ªªÂä°ËØ¥Êòé„ÄÅÈ¢ÑÁÆóÂíå Stripe ÊîØ‰ªòÈìæÊé•„ÄÇ',
      how_client_2: 'Êü•ÁúãÊé•ÂçïÁöÑËá™Áî±ËÅå‰∏öËÄÖÔºåÈÄöËøá WhatsApp/ÈÇÆÁÆ±Ê≤üÈÄöÁªÜËäÇ„ÄÇ',
      how_client_3: 'ÈÄöËøá Stripe ÂÆâÂÖ®‰ªòÊ¨æÔºåÊî∂Âà∞ AI + ‰∫∫Â∑•‰ºòÂåñÂêéÁöÑÊàêÊûú„ÄÇ',
      how_freelancer_title: 'Ëá™Áî±ËÅå‰∏öËÄÖ',
      how_freelancer_1: 'Ê≥®ÂÜåË¥¶Âè∑Âπ∂ÂÆåÂñÑ‰∏™‰∫∫ËµÑÊñô„ÄÇ',
      how_freelancer_2: 'ÊµèËßàÂºÄÊîæ‰ªªÂä°ÔºåÊé•ÈÄÇÂêàËá™Â∑±ÁöÑ‰ªªÂä°„ÄÇ',
      how_freelancer_3: '‰∫§‰ªòÊàêÊûúÔºåÂπ∂‰∏éÂÆ¢Êà∑Á°ÆËÆ§ Stripe ÁªìÁÆó„ÄÇ',
      how_owner_title: 'Âπ≥Âè∞Êã•ÊúâËÄÖÔºà‰Ω†Ôºâ',
      how_owner_1: 'Âú® Stripe ‰∫ßÂìÅ/ÈìæÊé•ÈáåËÆæÁΩÆÂπ≥Âè∞ÊäΩÊàê„ÄÇ',
      how_owner_2: '‰Ω†ÂÜ≥ÂÆöÈÇÄËØ∑Âì™‰∫õÂÆ¢Êà∑ÂíåËá™Áî±ËÅå‰∏öËÄÖËøõÂÖ•Á≥ªÁªü„ÄÇ',
      how_owner_3: '‰Ω†‰∏ìÊ≥®‰∫éÂºïÊµÅÂíåÂÖ≥Á≥ªÔºåÁΩëÁ´ôË¥üË¥£ÊµÅÁ®ã„ÄÇ',
      footer_rights: 'ÁâàÊùÉÊâÄÊúâ„ÄÇÊú¨ÁΩëÁ´ô‰∏ç‰øùÂ≠ò‰ªª‰ΩïÈì∂Ë°åÂç°‰ø°ÊÅØÔºåÊâÄÊúâ‰ªòÊ¨æÁî± Stripe Â§ÑÁêÜ„ÄÇ',
      auth_title: 'ÁôªÂΩï / Ê≥®ÂÜå',
      auth_sub: '‰∏Ä‰∏™Ë¥¶Êà∑Âç≥ÂèØÂêåÊó∂Âèë‰ªªÂä°ÂíåÊé•‰ªªÂä°„ÄÇ',
      auth_email: 'ÈÇÆÁÆ±',
      auth_name: 'ÊòæÁ§∫ÂêçÁß∞',
      auth_password: 'ÂØÜÁ†Å',
      auth_role_label: 'ÁôªÂΩïÂêéÁöÑÈªòËÆ§Ë∫´‰ªΩ',
      auth_role_client: 'ÂÆ¢Êà∑',
      auth_role_freelancer: 'Ëá™Áî±ËÅå‰∏öËÄÖ',
      auth_submit: 'ÁªßÁª≠',
      btn_cancel: 'ÂèñÊ∂à',
      task_modal_title: 'ÂèëÂ∏ÉÊñ∞‰ªªÂä°',
      task_modal_sub: 'Â∞ΩÈáèÂÜôÊ∏ÖÊ•ö‰Ω†ÈúÄË¶Å‰ªÄ‰πàÔºåÂèØ‰ª•Á≤òË¥¥ Stripe ÊîØ‰ªòÈìæÊé•‰ª•‰æøÂú®Á∫øÊî∂Ê¨æ„ÄÇ',
      task_title_label: '‰ªªÂä°Ê†áÈ¢ò',
      task_desc_label: '‰ªªÂä°ÊèèËø∞',
      task_budget_label: 'È¢ÑÁÆó',
      task_location_label: 'ÂÆ¢Êà∑Âú∞Âå∫ÔºàÂèØÈÄâÔºâ',
      task_stripe_label: 'Stripe ÊîØ‰ªòÈìæÊé•ÔºàÂèØÈÄâÔºâ',
      task_stripe_helper: 'ÂºÄÈÄö Stripe Ê≠£ÂºèÊî∂Ê¨æÂêéÔºåÊääÁúüÂÆû Payment Link Á≤òË¥¥Âà∞ËøôÈáå„ÄÇÂ¶ÇÊûúÁïôÁ©∫ÔºåÊ≠§‰ªªÂä°‰∏ç‰ºöÊòæÁ§∫‚Äú‰ΩøÁî® Stripe ‰ªòÊ¨æ‚ÄùÊåâÈíÆ„ÄÇ',
      task_submit: '‰øùÂ≠ò‰ªªÂä°'
    },
    // For brevity, other languages reuse English text
    ar: {}, fr: {}, de: {}
  };
  translations.ar = translations.fr = translations.de = translations.en;

  function applyTranslations(lang) {
    const dict = translations[lang] || translations.en;
    document.querySelectorAll('[data-i18n]').forEach(el => {
      const key = el.getAttribute('data-i18n');
      if (dict[key]) {
        if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
          el.placeholder = dict[key];
        } else {
          el.textContent = dict[key];
        }
      }
    });
  }

  // ------- Data helpers -------
  function loadJSON(key, fallback) {
    try {
      const v = localStorage.getItem(key);
      return v ? JSON.parse(v) : fallback;
    } catch (e) {
      return fallback;
    }
  }
  function saveJSON(key, value) {
    localStorage.setItem(key, JSON.stringify(value));
  }

  function seedTasksIfEmpty() {
    let tasks = loadJSON(STORAGE_KEYS.tasks, null);
    if (!tasks || !Array.isArray(tasks) || !tasks.length) {
      tasks = [
        {
          id: 1,
          title: 'Èù¢ÂêëÁæéÂõΩÈÄÄ‰ºëÊäïËµÑËÄÖÁöÑ AI ÈïøÁØáÊä•ÈÅì',
          description: 'Êí∞ÂÜô‰∏ÄÁØá 3,000 Â≠óÁöÑÈïøÁØáÊñáÁ´†ÔºåÁõÆÊ†áËØªËÄÖ‰∏∫Âç≥Â∞ÜÈÄÄ‰ºëÁöÑÁæéÂõΩ‰∏≠‰∫ßÁî∑ÊÄß„ÄÇÈúÄË¶ÅÊ°à‰æãÁ†îÁ©∂„ÄÅÈ£éÈô©ÊèêÁ§∫ÂíåÊ∏ÖÊô∞ÁöÑÂ∞èÊ†áÈ¢òÁªìÊûÑ„ÄÇ',
          budget: 450,
          currency: 'USD',
          clientName: 'Á§∫‰æãÂÆ¢Êà∑',
          location: 'Houston, TX ¬∑ United States',
          status: 'open',
          createdAt: Date.now() - 86400000,
          createdByEmail: 'demo-client@example.com',
          acceptedByEmail: null,
          paymentLink: ''
        },
        {
          id: 2,
          title: 'LinkedIn ÂÜÖÂÆπÂåÖÔºàÊúàÂ∫¶ 10 ÁØáÔºâ',
          description: '‰∏∫‰∏Ä‰Ωç 55+ ÁæéÂõΩÁî∑ÊÄßÈ´òÁÆ°Êí∞ÂÜô 10 ÁØá LinkedIn Â∏ñÂ≠êÔºå‰∏ªÈ¢òÂõ¥ÁªïÈ¢ÜÂØºÂäõ„ÄÅÈÄÄ‰ºëËßÑÂàí‰ª•Âèä AI ‰∏éÂïÜ‰∏ö„ÄÇ',
          budget: 320,
          currency: 'USD',
          clientName: 'Á§∫‰æãÂÆ¢Êà∑',
          location: 'Dallas, TX ¬∑ United States',
          status: 'open',
          createdAt: Date.now() - 3600000,
          createdByEmail: 'demo-client@example.com',
          acceptedByEmail: null,
          paymentLink: ''
        },
        {
          id: 3,
          title: 'WhatsApp AI Ëá™Âä®ÂõûÂ§çÊµÅÁ®ãÊê≠Âª∫',
          description: '‰∏∫ÁæéÂõΩÂú∞Âå∫ÂÆ¢Êà∑Êê≠Âª∫‰∏Ä‰∏™ÈíàÂØπ 55+ Áî∑ÊÄßÁöÑ WhatsApp Ëá™Âä®ÂõûÂ§çÊµÅÁ®ãÔºåÂåÖÊã¨Ê¨¢ËøéËØùÊúØ„ÄÅÂ∏∏ËßÅÈóÆÈ¢òÂíåËΩ¨ Stripe ‰ªòÊ¨æÁöÑÈÄªËæëËÆæËÆ°„ÄÇ',
          budget: 580,
          currency: 'USD',
          clientName: 'Á§∫‰æãÂÆ¢Êà∑',
          location: 'Remote ¬∑ Global',
          status: 'open',
          createdAt: Date.now(),
          createdByEmail: 'demo-client@example.com',
          acceptedByEmail: null,
          paymentLink: ''
        }
      ];
      saveJSON(STORAGE_KEYS.tasks, tasks);
    }
    return tasks;
  }

  function getCurrentUser() {
    return loadJSON(STORAGE_KEYS.user, null);
  }
  function setCurrentUser(user) {
    if (user) saveJSON(STORAGE_KEYS.user, user);
    else localStorage.removeItem(STORAGE_KEYS.user);
  }
  function getUsers() {
    return loadJSON(STORAGE_KEYS.users, []);
  }
  function setUsers(arr) {
    saveJSON(STORAGE_KEYS.users, arr);
  }

  // ------- Rendering -------
  let tasks = seedTasksIfEmpty();

  function formatCurrency(amount, currency) {
    return (currency === 'USD' ? '$' : currency + ' ') + amount;
  }

  function renderStats() {
    const open = tasks.filter(t => t.status === 'open').length;
    const progress = tasks.filter(t => t.status === 'in_progress').length;
    const completed = tasks.filter(t => t.status === 'completed').length;
    document.getElementById('statOpen').textContent = open;
    document.getElementById('statProgress').textContent = progress;
    document.getElementById('statCompleted').textContent = completed;

    const mini = document.getElementById('heroMiniTasks');
    mini.innerHTML = '';
    tasks.slice(0, 3).forEach(t => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>
          <span class="task-title">${t.title}</span>
          <span class="task-meta">${t.clientName || ''}</span>
        </td>
        <td>${formatCurrency(t.budget, t.currency)}</td>
        <td><span class="badge-status badge-status-${t.status === 'open' ? 'open' : t.status === 'in_progress' ? 'progress' : 'completed'}">
          ${t.status}
        </span></td>`;
      mini.appendChild(tr);
    });
  }

  function renderTasks() {
    const tbody = document.getElementById('taskTableBody');
    tbody.innerHTML = '';

    const currentUser = getCurrentUser();
    const statusFilter = document.getElementById('filterStatus').value;
    const roleFilter = document.getElementById('filterRoleView').value;
    const query = document.getElementById('searchInput').value.toLowerCase().trim();

    tasks.forEach(task => {
      if (statusFilter !== 'all' && task.status !== statusFilter) return;

      if (roleFilter === 'client' && currentUser) {
        if (task.createdByEmail !== currentUser.email) return;
      }
      if (roleFilter === 'freelancer' && currentUser) {
        if (task.acceptedByEmail !== currentUser.email) return;
      }
      if (!currentUser && (roleFilter === 'client' || roleFilter === 'freelancer')) return;

      if (query && !(
        task.title.toLowerCase().includes(query) ||
        task.description.toLowerCase().includes(query) ||
        (task.clientName || '').toLowerCase().includes(query)
      )) return;

      const tr = document.createElement('tr');

      const statusClass =
        task.status === 'open' ? 'badge-status-open'
          : task.status === 'in_progress' ? 'badge-status-progress'
            : 'badge-status-completed';

      let actionsHTML = '';

      const loggedIn = !!currentUser;
      const isClient = currentUser && task.createdByEmail === currentUser.email;
      const isFreelancer = currentUser && task.acceptedByEmail === currentUser.email;

      if (task.status === 'open') {
        actionsHTML += `<button class="btn-table btn-accept ${!loggedIn ? 'btn-disabled' : ''}"
          data-action="accept" data-id="${task.id}">
          ${loggedIn ? 'Accept' : 'Login to accept'}
        </button>`;
      } else if (task.status === 'in_progress' && isClient) {
        actionsHTML += `<button class="btn-table"
          data-action="complete" data-id="${task.id}">
          Mark completed
        </button>`;
      }

      if (task.paymentLink) {
        actionsHTML += `<button class="btn-table btn-pay"
          data-action="pay" data-id="${task.id}">
          Pay with Stripe
        </button>`;
      }

      tr.innerHTML = `
        <td>
          <span class="task-title">${task.title}</span>
          <span class="task-meta">${task.description.slice(0, 90)}${task.description.length > 90 ? '‚Ä¶' : ''}</span>
        </td>
        <td>${formatCurrency(task.budget, task.currency)}</td>
        <td>${task.clientName || ''}</td>
        <td>${task.location || ''}</td>
        <td>
          <span class="badge-status ${statusClass}">
            ${task.status}
          </span>
        </td>
        <td>${actionsHTML}</td>
      `;
      tbody.appendChild(tr);
    });

    renderStats();
  }

  // ------- Modals -------
  function openModal(id) {
    document.getElementById(id).style.display = 'flex';
  }
  function closeModal(id) {
    document.getElementById(id).style.display = 'none';
  }

  document.querySelectorAll('.modal-backdrop').forEach(backdrop => {
    backdrop.addEventListener('click', e => {
      if (e.target === backdrop) {
        backdrop.style.display = 'none';
      }
    });
  });
  document.querySelectorAll('[data-close]').forEach(btn => {
    btn.addEventListener('click', () => closeModal(btn.getAttribute('data-close')));
  });

  // ------- Auth logic -------
  function updateUserLabel() {
    const label = document.getElementById('currentUserLabel');
    const user = getCurrentUser();
    if (user) {
      label.textContent = `Logged in as ${user.name} (${user.role})`;
      document.getElementById('btnNavLogin').textContent = 'Log out';
    } else {
      label.textContent = '';
      document.getElementById('btnNavLogin').textContent = translations[getCurrentLang()].nav_login;
    }
  }

  function getCurrentLang() {
    return localStorage.getItem(STORAGE_KEYS.lang) || 'en';
  }

  function initAuth() {
    const btnNavLogin = document.getElementById('btnNavLogin');
    btnNavLogin.addEventListener('click', () => {
      const user = getCurrentUser();
      if (user) {
        // log out
        setCurrentUser(null);
        updateUserLabel();
        renderTasks();
      } else {
        document.getElementById('authError').style.display = 'none';
        openModal('authModal');
      }
    });

    document.getElementById('btnAuthSubmit').addEventListener('click', () => {
      const email = document.getElementById('authEmail').value.trim().toLowerCase();
      const name = document.getElementById('authName').value.trim();
      const pass = document.getElementById('authPassword').value;
      const role = document.querySelector('input[name="authRole"]:checked').value;
      const errorEl = document.getElementById('authError');
      if (!email || !name || !pass) {
        errorEl.textContent = 'Please fill in all fields.';
        errorEl.style.display = 'block';
        return;
      }
      if (pass.length < 6) {
        errorEl.textContent = 'Password must be at least 6 characters.';
        errorEl.style.display = 'block';
        return;
      }
      errorEl.style.display = 'none';

      let users = getUsers();
      let existing = users.find(u => u.email === email);
      if (!existing) {
        existing = { email, name, password: pass, role };
        users.push(existing);
        setUsers(users);
      }
      setCurrentUser(existing);
      updateUserLabel();
      closeModal('authModal');
      renderTasks();
    });
  }

  // ------- Task creation and actions -------
  function requireLogin(action) {
    const user = getCurrentUser();
    if (!user) {
      alert('Please log in first.');
      openModal('authModal');
      return false;
    }
    return true;
  }

  function initTaskCreation() {
    const openTaskModalBtns = ['btnNavNewTask', 'btnHeroPost', 'btnNewTask'];
    openTaskModalBtns.forEach(id => {
      const el = document.getElementById(id);
      if (!el) return;
      el.addEventListener('click', () => {
        if (!requireLogin()) return;
        document.getElementById('taskError').style.display = 'none';
        document.getElementById('taskTitle').value = '';
        document.getElementById('taskDescription').value = '';
        document.getElementById('taskBudget').value = '';
        document.getElementById('taskLocation').value = '';
        document.getElementById('taskStripeLink').value = '';
        openModal('taskModal');
      });
    });

    document.getElementById('btnTaskSubmit').addEventListener('click', () => {
      const user = getCurrentUser();
      if (!user) {
        alert('Please log in first.');
        return;
      }
      const title = document.getElementById('taskTitle').value.trim();
      const desc = document.getElementById('taskDescription').value.trim();
      const budgetStr = document.getElementById('taskBudget').value.trim();
      const currency = document.getElementById('taskCurrency').value;
      const location = document.getElementById('taskLocation').value.trim();
      const link = document.getElementById('taskStripeLink').value.trim();
      const errorEl = document.getElementById('taskError');

      if (!title || !desc || !budgetStr) {
        errorEl.textContent = 'Title, description and budget are required.';
        errorEl.style.display = 'block';
        return;
      }
      const budget = Number(budgetStr);
      if (!Number.isFinite(budget) || budget <= 0) {
        errorEl.textContent = 'Budget must be a positive number.';
        errorEl.style.display = 'block';
        return;
      }
      if (link && !/^https?:\/\/.+/i.test(link)) {
        errorEl.textContent = 'Stripe Payment Link looks invalid.';
        errorEl.style.display = 'block';
        return;
      }
      errorEl.style.display = 'none';

      const newId = tasks.length ? Math.max(...tasks.map(t => t.id)) + 1 : 1;
      const t = {
        id: newId,
        title,
        description: desc,
        budget,
        currency,
        clientName: user.name,
        location,
        status: 'open',
        createdAt: Date.now(),
        createdByEmail: user.email,
        acceptedByEmail: null,
        paymentLink: link
      };
      tasks.unshift(t);
      saveJSON(STORAGE_KEYS.tasks, tasks);
      closeModal('taskModal');
      renderTasks();
    });

    document.getElementById('taskTableBody').addEventListener('click', e => {
      const btn = e.target.closest('button[data-action]');
      if (!btn) return;
      const action = btn.getAttribute('data-action');
      const id = Number(btn.getAttribute('data-id'));
      const task = tasks.find(t => t.id === id);
      if (!task) return;

      if (action === 'accept') {
        if (!requireLogin()) return;
        const user = getCurrentUser();
        if (task.status !== 'open') return;
        task.status = 'in_progress';
        task.acceptedByEmail = user.email;
        saveJSON(STORAGE_KEYS.tasks, tasks);
        renderTasks();
      } else if (action === 'complete') {
        task.status = 'completed';
        saveJSON(STORAGE_KEYS.tasks, tasks);
        renderTasks();
      } else if (action === 'pay') {
        if (!task.paymentLink) return;
        window.open(task.paymentLink, '_blank');
      }
    });

    document.getElementById('btnHeroViewAll').addEventListener('click', () => {
      const y = document.querySelector('.section-title').getBoundingClientRect().top +
        window.scrollY - 80;
      window.scrollTo({ top: y, behavior: 'smooth' });
    });
    document.getElementById('btnHeroFreelancer').addEventListener('click', () => {
      openModal('authModal');
      document.querySelector('input[name="authRole"][value="freelancer"]').checked = true;
    });
  }

  // ------- Filters / search -------
  function initFilters() {
    ['filterStatus', 'filterRoleView', 'searchInput'].forEach(id => {
      const el = document.getElementById(id);
      if (!el) return;
      const evt = id === 'searchInput' ? 'input' : 'change';
      el.addEventListener(evt, renderTasks);
    });
  }

  // ------- Language switch -------
  function initLang() {
    const select = document.getElementById('langSelect');
    const saved = getCurrentLang();
    select.value = saved;
    applyTranslations(saved);

    select.addEventListener('change', () => {
      const lang = select.value;
      localStorage.setItem(STORAGE_KEYS.lang, lang);
      applyTranslations(lang);
      updateUserLabel();
    });
  }

  // ------- Init -------
  document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('year').textContent = new Date().getFullYear();
    initLang();
    initAuth();
    initTaskCreation();
    initFilters();
    updateUserLabel();
    renderTasks();
  });
</script>
</body>
</html>
